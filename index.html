<!doctype html>
<html>
	<head>
		<meta charset="utf-8">
		<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">

		<title>reveal.js</title>

		<link rel="stylesheet" href="dist/reset.css">
		<link rel="stylesheet" href="dist/reveal.css">
		<link rel="stylesheet" href="css/citylife.css" id="theme">

		<!-- Theme used for syntax highlighted code -->
		<link rel="stylesheet" href="plugin/highlight/monokai.css" id="highlight-theme">
	</head>
	<body>
		<div class="reveal">
			<div class="slides">
                <section 
                    data-background-image="images/main-cross.png"
                    data-background-size="contain"
                    >
                    <button id="request_full_screen">Full Screen</button>
                    <div id="s1_text_container">
                        <div id="s1_praise"><img src="images/praise.png"/></div>
                        <div id="s1_chinese_church"><img src="images/citylife_chinese_church.png"/></div>
                    </div>
                    <audio data-autoplay loop id="s1_audio">
                        <source src="audio/让赞美飞扬.mp3" type="audio/mpeg">
                    </audio>
                </section>
                <section
                    data-background-image="images/countdown_bg.jpg"
                    data-background-size="cover"
                    data-state="countdown_start"
                    >
                    <div id="s2_bible_title">
                        <!-- 经文标题开始，请注意控制数量必须和下面经文内容一致 -->
                        <div class="text1 text active">
                            使徒行传 17：22-31
                        </div>
                        <div class="text2 text">
                            哥林多前书 9: 20-23 
                        </div>
                        <div class="text3 text">
                            使徒行传 20: 19				
                                    </div>
                        <div class="text4 text">
                            哥林多前书 13：1-3
                                    </div>
                        <!-- 经文标题定义结束 -->
                    </div>
                    <div id="s2_bible_text">
                        <!-- 经文正文开始，请从这里开始编辑 -->
                        <div class="text1 text active">

			保罗站在亚略巴古当中，说：“众位雅典人哪，我看你们凡事很敬畏鬼神。
			我游行的时候，观看你们所敬拜的，遇见一座坛，上面写着‘未识之神’。你们所不认识而敬拜的，我现在告诉你们：
			创造宇宙和其中万物的神，既是天地的主，就不住人手所造的殿，
			也不用人手服侍，好像缺少什么；自己倒将生命、气息、万物，赐给万人。
			他从一本造出万族的人（“本”有古卷作“血脉”），住在全地上，并且预先定准他们的年限和所住的疆界，
			要叫他们寻求　神，或者可以揣摩而得，其实他离我们各人不远，
			我们生活、动作、存留，都在乎他。就如你们作诗的，有人说：‘我们也是他所生的。’
			我们既是　神所生的，就不当以为　神的神性像人用手艺、心思所雕刻的金、银、石。
			世人蒙昧无知的时候，神并不监察，如今却吩咐各处的人都要悔改。
			因为他已经定了日子，要藉着他所设立的人按公义审判天下，并且叫他从死里复活，给万人作可信的凭据。”
                        </div>
                        <div class="text2 text">

			向犹太人，我就作犹太人，为要得犹太人；向律法以下的人，我虽不在律法以下，还是作律法以下的人，为要得律法以下的人；
			向没有律法的人，我就作没有律法的人，为要得没有律法的人。其实我在　神面前，不是没有律法；在基督面前，正在律法之下。
			向软弱的人，我就作软弱的人，为要得软弱的人。向什么样的人，我就作什么样的人。无论如何总要救些人。
			凡我所行的，都是为福音的缘故，为要与人同得这福音的好处。
                        </div>
                        <div class="text3 text">

			服侍主，凡事谦卑，眼中流泪，又因犹太人的谋害，经历试炼。
                        </div>
                        <div class="text4 text">

			我若能说万人的方言，并天使的话语，却没有爱，我就成了鸣的锣、响的钹一般。
			我若有先知讲道之能，也明白各样的奥秘、各样的知识，而且有全备的信，叫我能够移山，却没有爱，我就算不得什么。
			我若将所有的周济穷人，又舍己身叫人焚烧，却没有爱，仍然与我无益。
                        </div>

                        <!-- 经文内容结束，以下尽量不要修改 -->
                    </div>
                    <div id="s2_timer">3:00</div>
                    <audio data-autoplay loop>
                        <source src="audio/countdown.mp3" type="audio/mpeg">
                    </audio>
                </section>
                <section
                    data-state="google_slide"
                    >
                    <iframe src="https://docs.google.com/presentation/d/e/2PACX-1vReAVR3UbObyn5Al6CPwJqy3WYoewPbjZNPP_DeM3gbSEOylOa52DTSdRr4PhqNFai23gbexXjE6m6i/embed?start=false&loop=false&delayms=3000" frameborder="0" width="1920" height="1109" allowfullscreen="true" mozallowfullscreen="true" webkitallowfullscreen="true"></iframe>
                </section>
			</div>
		</div>

		<script src="dist/reveal.js"></script>
		<script src="plugin/notes/notes.js"></script>
		<script src="plugin/markdown/markdown.js"></script>
		<script src="plugin/highlight/highlight.js"></script>
		<script src="scripts/fullscreen-polyfill.js"></script>
		<script>
			function closeFullscreen() {
				if (document.exitFullscreen) {
					document.exitFullscreen();
				} else if (document.mozCancelFullScreen) { /* Firefox */
				document.mozCancelFullScreen();
				} else if (document.webkitExitFullscreen) { /* Chrome, Safari and Opera */
				document.webkitExitFullscreen();
				} else if (document.msExitFullscreen) { /* IE/Edge */
				document.msExitFullscreen();
				}
			}
            function switchBibleText(number) {
                var list;
                var nextItem;
                list = document.querySelectorAll('#s2_bible_title .text');
                list.forEach(function(item) {
                    item.classList.remove('active');
                });
                nextItem = document.querySelector('#s2_bible_title .text' + number);
                nextItem.classList.add('active');

                list = document.querySelectorAll('#s2_bible_text .text');
                list.forEach(function(item) {
                    item.classList.remove('active');
                });
                nextItem = document.querySelector('#s2_bible_text .text' + number);
                nextItem.classList.add('active');
            }
			// More info about initialization & config:
			// - https://revealjs.com/initialization/
			// - https://revealjs.com/config/
			Reveal.initialize({
                width: 1920,
                height: 1080,
				hash: true,
                margin: 0,
                disableLayout: true,
                center: false,

				// Learn about plugins: https://revealjs.com/plugins/
				plugins: [ RevealMarkdown, RevealHighlight, RevealNotes ]
			});
            var timerHandler;
            var timer = event => {
                if (event.currentSlide.dataset.state === 'google_slide') {
                    document.exitFullscreen();
                }
                if (event.currentSlide.dataset.state === 'countdown_start') {
                    if (timerHandler) {
                        window.clearInterval(timerHandler);
                        timerHandler = null;
                    }
                    var count = 180;
                    var position = 0;
                    var elem = document.getElementById('s2_timer');
                    elem.innerHTML = '3:00'
                    timerHandler = window.setInterval(function() {
                        count--;
                        var minute = Math.floor(count / 60);
                        var second = count - (minute * 60);
                        elem.innerHTML = minute + ':' + String(second).padStart(2, '0');
                        if (count === 0) {
                            window.clearInterval(timerHandler);
                            timerHandler = null;
                        }
                        var total_titles = document.querySelectorAll('#s2_bible_title .text').length;
                        var total_texts = document.querySelectorAll('#s2_bible_text .text').length;
                        if (total_texts !== total_titles) {
                            alert ('经文标题和经文数量不一致');
                        }
                        // 正式使用请uncomment下面这一行，并comment测试用的2:58, 2:56等时间戳
                        if ([160, 145, 130, 115, 100, 80, 60, 40, 20].includes(count)) {
                        //if ([178, 176, 174, 172, 170, 168, 166, 164, 162, 160].includes(count)) {
                            var next_position = ((++position) % total_titles + 1);
                            switchBibleText(next_position);
                        }
                    }, 1000);
                    /*
                    var marquee = document.getElementById('s2_marquee');
                    marquee.classList.add('animate')
                   */
                } else {
                    window.clearInterval(timerHandler);
                    timerHandler = null;
                    /*
                    var marquee = document.getElementById('s2_marquee');
                    marquee.classList.remove('animate')
                   */
                }
            };
            Reveal.on('slidetransitionend', timer);
            Reveal.on('ready', timer);
            var created = false;
            var videoId;
            Reveal.on('ready', event => {
                videoId = event.currentSlide.querySelector('audio')
            })
            document.addEventListener('click', () => {
				if (!created) {
					created = true;
					//var v = document.getElementById('s1_audio');
                    var v = videoId;
					v.play().catch((e)=>{ console.log(e)});                
	            }
            });
            var fullScreenButton = document.getElementById('request_full_screen');
            fullScreenButton.addEventListener('click', function() {
                document.documentElement.requestFullscreen();
                fullScreenButton.parentNode.removeChild(fullScreenButton);
            })
		</script>
	</body>
</html>
